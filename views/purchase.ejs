<!-- views/purchase.ejs -->
<%- include('includes/_header') %>

<main id="main" style="padding: 1.5rem;">
  <h2>Purchase Plan</h2>

  <form id="drug_days" method="GET" action="/purchase" style="margin-bottom: 1rem;">
    <label for="days">Days: </label>
    <input type="number" id="days" name="days" value="<%= days || 30 %>" min="1" max="365" />
    <button type="submit">Enter</button>
  </form>

  <p>Plan for <strong><%= days %></strong> day(s)</p>

  <table id="purchase_table" border="1" cellpadding="8" cellspacing="0">
    <thead>
      <tr>
        <th>#</th>
        <th>Name</th>
        <th>Cards to buy</th>
        <th>Packs to buy</th>
      </tr>
    </thead>
    <tbody>
      <% if (drugs && drugs.length) { %>
        <% for (let i = 0; i < drugs.length; i++) { %>
          <tr>
            <td><%= i + 1 %></td>
            <td><%= drugs[i].name %></td>
            <td>
              <%= drugs[i].cardsToBuy %>
              <small style="color:#666;">(pills/card: <%= drugs[i].pillsPerCard %>)</small>
            </td>
            <td>
              <%= drugs[i].cardsToBuy %>
              <small style="color:#666;">(cards/pack: <%= drugs[i].cardsPerPack %>, pills/pack: <%= drugs[i].pillsPerPack %>)</small>
            </td>
          </tr>
        <% } %>
      <% } else { %>
        <tr><td colspan="4">No data.</td></tr>
      <% } %>
    </tbody>
  </table>
</main>

<%- include('includes/_footer') %>